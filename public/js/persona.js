/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var T=function(e,r){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var u in o)o.hasOwnProperty(u)&&(t[u]=o[u])},T(e,r)};function w(e,r){T(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var x=function(){function e(r){this.type=r}return e}(),y=function(e){w(r,e);function r(){return e.call(this,"CommunicationFailed")||this}return r}(x),g=function(e){w(r,e);function r(t,o){var u=e.call(this,t)||this;return u.deviceId=o,u}return r}(x),Q=function(e){w(r,e);function r(t){return e.call(this,"DeviceConnected",t)||this}return r}(g),nn=function(e){w(r,e);function r(t){return e.call(this,"DeviceDisconnected",t)||this}return r}(g),q;(function(e){e[e.Contact=1]="Contact",e[e.Contactless=2]="Contactless",e[e.Proximity=4]="Proximity"})(q||(q={}));var K;(function(e){e[e.SupportsPIN=1]="SupportsPIN",e[e.SupportsUID=2]="SupportsUID",e[e.IsPKI=65536]="IsPKI",e[e.IsPIV=131072]="IsPIV",e[e.IsReadOnly=2147483648]="IsReadOnly"})(K||(K={}));var hn=function(e){w(r,e);function r(t,o){var u=e.call(this,"CardInserted",t)||this;return u.cardId=o,u}return r}(g),ln=function(e){w(r,e);function r(t,o){var u=e.call(this,"CardRemoved",t)||this;return u.cardId=o,u}return r}(g),G=function(){function e(){this.handlers={}}return e.prototype._on=function(r,t){return this.handlers[r]=this.handlers[r]||[],this.handlers[r].push(t),t},e.prototype._off=function(r,t){if(r){var o=this.handlers[r];o&&(t?this.handlers[r]=o.filter(function(u){return u!==t}):delete this.handlers[r])}else this.handlers={};return this},e.prototype.emit=function(r){var t=this;if(r){var o=r.type,u=this["on"+o];u&&this.invoke(u,r);var h=this.handlers[o];h&&h.forEach(function(E){return t.invoke(E,r)})}},e.prototype.invoke=function(r,t){try{r(t)}catch(o){console.error(o)}},e}(),dn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},L={exports:{}};(function(e,r){(function(t,o){o(r)})(dn,function(t){var o=function(){function n(i,a,s){this.href=n.create(i,a,s)}return n.getSanitizedQuery=function(i){return Object.keys(i).map(function(a){return[a,i[a]].map(encodeURIComponent).join("=")}).join("&")},n.create=function(i,a,s){return i+(a?"/"+encodeURI(a):"")+(s?"?"+n.getSanitizedQuery(s):"")},n}();(function(n){n[n.Multiple=1]="Multiple",n[n.FacialFeatures=2]="FacialFeatures",n[n.Voice=4]="Voice",n[n.Fingerprint=8]="Fingerprint",n[n.Iris=16]="Iris",n[n.Retina=32]="Retina",n[n.HandGeometry=64]="HandGeometry",n[n.SignatureDynamics=128]="SignatureDynamics",n[n.KeystrokeDynamics=256]="KeystrokeDynamics",n[n.LipMovement=512]="LipMovement",n[n.ThermalFaceImage=1024]="ThermalFaceImage",n[n.ThermalHandImage=2048]="ThermalHandImage",n[n.Gait=4096]="Gait"})(t.BioFactor||(t.BioFactor={})),function(n){n[n.None=0]="None",n[n.Neurotechnologija=49]="Neurotechnologija",n[n.DigitalPersona=51]="DigitalPersona",n[n.Cognitec=99]="Cognitec",n[n.Innovatrics=53]="Innovatrics"}(t.BioSampleFormatOwner||(t.BioSampleFormatOwner={}));var u=function(){function n(i,a){this.FormatOwner=i,this.FormatID=a}return n}();(function(n){n[n.Raw=1]="Raw",n[n.Intermediate=2]="Intermediate",n[n.Processed=4]="Processed",n[n.RawWSQCompressed=8]="RawWSQCompressed",n[n.Encrypted=16]="Encrypted",n[n.Signed=32]="Signed"})(t.BioSampleType||(t.BioSampleType={})),function(n){n[n.Any=0]="Any",n[n.Verify=1]="Verify",n[n.Identify=2]="Identify",n[n.Enroll=3]="Enroll",n[n.EnrollForVerificationOnly=4]="EnrollForVerificationOnly",n[n.EnrollForIdentificationOnly=5]="EnrollForIdentificationOnly",n[n.Audit=6]="Audit"}(t.BioSamplePurpose||(t.BioSamplePurpose={})),function(n){n[n.None=0]="None",n[n.XTEA=1]="XTEA"}(t.BioSampleEncryption||(t.BioSampleEncryption={}));var h=function(){function n(i,a,s,c,l,d){this.Factor=i,this.Format=a,this.Type=s,this.Purpose=c,this.Quality=l,this.Encryption=d}return n}(),E=function(){function n(i,a){this.Header=i,this.Data=a,this.Version=1}return n}();/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation. All rights reserved.
	    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	    this file except in compliance with the License. You may obtain a copy of the
	    License at http://www.apache.org/licenses/LICENSE-2.0

	    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	    MERCHANTABLITY OR NON-INFRINGEMENT.

	    See the Apache Version 2.0 License for specific language governing permissions
	    and limitations under the License.
	    ***************************************************************************** */var B=function(){return B=Object.assign||function(i){for(var a,s=1,c=arguments.length;s<c;s++){a=arguments[s];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(i[l]=a[l])}return i},B.apply(this,arguments)};function en(n,i){var a=typeof Symbol=="function"&&n[Symbol.iterator];if(!a)return n;var s=a.call(n),c,l=[],d;try{for(;(i===void 0||i-- >0)&&!(c=s.next()).done;)l.push(c.value)}catch(I){d={error:I}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(d)throw d.error}}return l}function tn(){for(var n=[],i=0;i<arguments.length;i++)n=n.concat(en(arguments[i]));return n}var J=function(){function n(){}return n.fromUtf8=function(i){return decodeURIComponent(escape(S.noBom(i)))},n.fromBase64=function(i){return n.fromUtf8(S.fromBase64(i))},n.fromBase64Url=function(i){return n.fromUtf8(S.fromBase64Url(i))},n.withBom=function(i){return"\uFEFF"+i},n.noBom=function(i){return i.replace(/^\uFEFF/,"")},n}(),S=function(){function n(){}return n.fromUtf16=function(i){return unescape(encodeURIComponent(J.noBom(i)))},n.fromBase64=function(i){return atob(i)},n.fromBase64Url=function(i){return n.fromBase64(N.fromBase64Url(i))},n.fromBytes=function(i){return String.fromCharCode.apply(String,tn(i))},n.withBom=function(i){return"ï»¿"+i},n.noBom=function(i){return i.replace(/^\xEF\xBB\xBF/,"")},n}(),N=function(){function n(){}return n.fromUtf8=function(i){return btoa(i)},n.fromUtf16=function(i){return n.fromUtf8(S.fromUtf16(i))},n.fromBase64Url=function(i){return(i.length%4===2?i+"==":i.length%4===3?i+"=":i).replace(/-/g,"+").replace(/_/g,"/")},n.fromBytes=function(i){return n.fromUtf8(S.fromBytes(i))},n.fromJSON=function(i){return n.fromUtf16(JSON.stringify(i))},n}(),_=function(){function n(){}return n.fromBase64=function(i){return i.replace(/\=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},n.fromUtf8=function(i){return n.fromBase64(N.fromUtf8(i))},n.fromUtf16=function(i){return n.fromBase64(N.fromUtf16(i))},n.fromBytes=function(i){return n.fromUtf8(S.fromBytes(i))},n.fromJSON=function(i){return n.fromUtf16(JSON.stringify(i))},n}(),rn=function(){function n(){}return n.fromBytes=function(i){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",s=0,c=0,l=0,d=0,I=0,U="",A=i.length,C=0,V=Math.floor(A/5)*5;C<V;)s=i[C++],c=i[C++],l=i[C++],d=i[C++],I=i[C++],U+=a[s>>>3]+a[(s<<2|c>>>6)&31]+a[c>>>1&31]+a[(c<<4|l>>>4)&31]+a[(l<<1|d>>>7)&31]+a[d>>>2&31]+a[(d<<3|I>>>5)&31]+a[I&31];var k=A-V;if(k===0)return U;switch(k){case 4:d=i[--A];case 3:l=i[--A];case 2:c=i[--A];case 1:s=i[--A]}switch(U+=a[s>>>3],k){case 1:return U+a[s<<2&31]+"======";case 2:return U+a[(s<<2|c>>>6)&31]+a[c>>>1&31]+a[c<<4&31]+"====";case 3:return U+a[(s<<2|c>>>6)&31]+a[c>>>1&31]+a[(c<<4|l>>>4)&31]+a[l<<1&31]+"===";case 4:return U+a[(s<<2|c>>>6)&31]+a[c>>>1&31]+a[(c<<4|l>>>4)&31]+a[(l<<1|d>>>7)&31]+a[d>>>2&31]+a[d<<3&31]+"="}return U},n}();(function(n){n[n.Unknown=0]="Unknown",n[n.NetBIOSDomain=1]="NetBIOSDomain",n[n.DNSDomain=2]="DNSDomain",n[n.SAM=3]="SAM",n[n.Simple=4]="Simple",n[n.UID=5]="UID",n[n.UPN=6]="UPN",n[n.Display=7]="Display",n[n.SID=8]="SID",n[n.DP=9]="DP"})(t.UserNameType||(t.UserNameType={}));var P=function(){function n(i,a){var s=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;this.name=i||"",this.type=a||(this.name.length===0||this.name==="*"?t.UserNameType.Unknown:this.name.indexOf("@")!==-1?t.UserNameType.UPN:this.name.indexOf("\\")!==-1?t.UserNameType.SAM:s.test(this.name)?t.UserNameType.UID:t.UserNameType.DP)}return n.prototype.isAnonymous=function(){return!this.name||this.name.length===0},n.prototype.isEveryone=function(){return this.name==="*"},n.Anonymous=function(){return new n("",t.UserNameType.Unknown)},n.Everyone=function(){return new n("*",t.UserNameType.Unknown)},n.fromJWT=function(i,a){var s=W.claims(i),c=s.sub&&s.sub instanceof n?s.sub:s.wan?new n(s.wan,a):s.sub?new n(s.sub,a||t.UserNameType.DP):n.Anonymous();return c},n}(),on=function(){function n(i,a,s){this.typ=i,this.cty=s,this.alg=a}return n}(),W=function(){function n(){}return n.claims=function(i){var a=i.split("."),s=JSON.parse(J.fromBase64Url(a[0]));if(s.cty==="JWT")return B(B({},s),new on);var c=JSON.parse(J.fromBase64Url(a[1]));if(typeof c.sub=="object"){var l=c.sub,d=l.name,I=l.type;c.sub=new P(d,I)}return c},n.errors=function(i){var a=[],s=n.claims(i),c=new Date().getTime()/1e3;return s.iat&&s.nbf&&s.iat>s.nbf&&a.push(new Error("JWT.Error.IssueTimeLaterThanNotBefore")),s.nbf&&s.nbf>c&&a.push(new Error("JWT.Error.NotEffectiveYet")),s.exp&&s.exp<=c&&a.push(new Error("JWT.Error.Expired")),a.length>0?a:null},n}();(function(n){n.TokensId="jti",n.IssuerName="iss",n.IssuedAt="iat",n.Audience="aud",n.NotBefore="nbf",n.ExpiresAfter="exp",n.SubjectName="sub",n.IssuerDomain="dom",n.SubjectUid="uid",n.ADGuid="ad_guid",n.CredentialsUsed="crd",n.Group="group",n.Role="role",n.WindowsAccountName="wan",n.T24Principal="t24"})(t.ClaimName||(t.ClaimName={}));var an=function(){function n(i){this.jwt=i}return n.None=function(){return new n("")},n}(),un=function(){function n(i,a,s){s===void 0&&(s=!0),this.id=i,this.data=a?s?_.fromUtf16(typeof a!="string"?JSON.stringify(a):a):JSON.stringify(a):null}return n.None=function(){return new n("")},n.Any=function(){return new n("*")},n.Password="D1A1F561-E14A-4699-9138-2EB523E132CC",n.Fingerprints="AC184A13-60AB-40E5-A514-E10F777EC2F9",n.Face="85AEAA44-413B-4DC1-AF09-ADE15892730A",n.SmartCard="D66CC98D-4153-4987-8EBE-FB46E848EA98",n.ContactlessCard="F674862D-AC70-48CA-B73E-64A22F3BAC44",n.ProximityCard="1F31360C-81C0-4EE0-9ACD-5A4400F66CC2",n.PIN="8A6FCEC3-3C8A-40C2-8AC0-A039EC01BA05",n.SecurityQuestions="B49E99C6-6C94-42DE-ACD7-FD6B415DF503",n.Bluetooth="E750A180-577B-47F7-ACD9-F89A7E27FA49",n.OneTimePassword="324C38BD-0B51-4E4D-BD75-200DA0C8177F",n.U2F="5D5F73AF-BCE5-4161-9584-42A61AED0E48",n.IWA="AE922666-9667-49BC-97DA-1EB0E1EF73D2",n.Email="7845D71D-AB67-4EA7-913C-F81E75C3A087",n.Behavior="193C41F6-5CF6-4525-84CC-223603DAC9AB",n.Cards="FCFA704C-144B-42DB-8DF3-13F5CD20C525",n}();(function(n){n[n.Unknown=0]="Unknown",n[n.RightThumb=1]="RightThumb",n[n.RightIndex=2]="RightIndex",n[n.RightMiddle=3]="RightMiddle",n[n.RightRing=4]="RightRing",n[n.RightLittle=5]="RightLittle",n[n.LeftThumb=6]="LeftThumb",n[n.LeftIndex=7]="LeftIndex",n[n.LeftMiddle=8]="LeftMiddle",n[n.LeftRing=9]="LeftRing",n[n.LeftLittle=10]="LeftLittle"})(t.FingerPosition||(t.FingerPosition={}));var sn=function(){function n(i){this.position=i}return n.fromJson=function(i){var a=i;return new n(a.position)},n}();(function(n){n[n.Jpeg=1]="Jpeg"})(t.FaceImageType||(t.FaceImageType={}));var cn=function(){function n(i,a){a===void 0&&(a=t.FaceImageType.Jpeg),this.ImageData=i,this.ImageType=a,this.Version=1}return n.fromDataURL=function(i){return new n(i.replace("data:image/jpeg;base64,",""))},n.fromCanvas=function(i,a){return a===void 0&&(a=1),n.fromDataURL(i.toDataURL("image/jpeg",a))},n.prototype.toBioSample=function(i,a,s){return i===void 0&&(i=new u(t.BioSampleFormatOwner.None,0)),a===void 0&&(a=t.BioSamplePurpose.Any),new E(new h(t.BioFactor.FacialFeatures,i,t.BioSampleType.Raw,a,-1,t.BioSampleEncryption.None),_.fromJSON(this))},n}();(function(n){n[n.Regular=0]="Regular",n[n.Custom=1]="Custom"})(t.QuestionType||(t.QuestionType={}));var H=function(){function n(i,a,s,c,l){if(this.number=i,this.lang_id=a,this.sublang_id=s,this.keyboard_layout=c,this.text=l,this.version=1,this.type=i<=100?t.QuestionType.Regular:t.QuestionType.Custom,this.type===t.QuestionType.Custom&&!l)throw new Error("Question text is required for custom questions")}return n.fromJson=function(i){var a=i;return new n(a.number,a.lang_id,a.sublang_id,a.keyboard_layout,a.text)},n}(),fn=function(){function n(i,a){this.text=a,this.number=i instanceof H?i.number:i}return n}();t.Answer=fn,t.Base32=rn,t.Base64=N,t.Base64Url=_,t.BioSample=E,t.BioSampleFormat=u,t.BioSampleHeader=h,t.Credential=un,t.FaceImage=cn,t.Finger=sn,t.JWT=W,t.Question=H,t.Ticket=an,t.Url=o,t.User=P,t.Utf16=J,t.Utf8=S,Object.defineProperty(t,"__esModule",{value:!0})})})(L,L.exports);var f=L.exports,F;(function(e){e[e.Response=0]="Response",e[e.Notification=1]="Notification"})(F||(F={}));var j=function(){function e(r,t){this.pending=[],this.webChannel=new WebSdk.WebChannelClient(r,t),this.webChannel.onConnectionSucceed=this.onConnectionSucceed.bind(this),this.webChannel.onConnectionFailed=this.onConnectionFailed.bind(this),this.webChannel.onDataReceivedTxt=this.onDataReceivedTxt.bind(this)}return e.prototype.send=function(r,t){var o=new Promise(function(u,h){r.resolve=u,r.reject=h,t&&(r.timer=window.setTimeout(function(){if(r.timer)try{r.reject(new Error("Timeout"))}catch{}},t))});return this.pending.push(r),this.webChannel.isConnected()?this.processRequestQueue():this.webChannel.connect(),o},e.prototype.onConnectionSucceed=function(){this.processRequestQueue()},e.prototype.onConnectionFailed=function(){if(this.pending.forEach(function(r){return r.reject(new Error("Communication failure."))}),this.pending=[],this.onCommunicationError)try{this.onCommunicationError()}catch{}},e.prototype.onDataReceivedTxt=function(r){var t=JSON.parse(f.Utf8.fromBase64Url(r));if(t.Type===F.Response){var o=JSON.parse(f.Utf8.fromBase64Url(t.Data||"")),u=this.findRequest(o);if(u!==null){u.timer&&(window.clearTimeout(u.timer),delete u.timer);var h=o.Result>>>0;h>2147483647?u.reject(new Error("0x"+h.toString(16))):u.resolve(o)}else console.log("Orphaned response: "+t.Type)}else if(t.Type===F.Notification){var E=JSON.parse(f.Utf8.fromBase64Url(t.Data||""));if(this.onNotification)try{this.onNotification(E)}catch{}}else console.log("Unknown message type: "+t.Type)},e.prototype.processRequestQueue=function(){var r=this;this.pending.forEach(function(t,o,u){t.sent||(r.webChannel.sendDataTxt(f.Base64Url.fromJSON(t.command)),u[o].sent=!0)})},e.prototype.findRequest=function(r){for(var t=0;t<this.pending.length;t++){var o=this.pending[t];if(o.sent&&o.command.Method===r.Method)return this.pending.splice(t,1),o}return null},e}(),m=function(){function e(r,t){this.Method=r,this.Parameters=t}return e}(),v=function(){function e(r){this.command=r,this.sent=!1}return e}(),D;(function(e){e[e.EnumerateReaders=1]="EnumerateReaders",e[e.EnumerateCards=2]="EnumerateCards",e[e.GetCardInfo=3]="GetCardInfo",e[e.GetCardUID=4]="GetCardUID",e[e.GetDPCardAuthData=5]="GetDPCardAuthData",e[e.GetDPCardEnrollData=6]="GetDPCardEnrollData",e[e.Subscribe=100]="Subscribe",e[e.Unsubscribe=101]="Unsubscribe"})(D||(D={}));var R;(function(e){e[e.ReaderConnected=1]="ReaderConnected",e[e.ReaderDisconnected=2]="ReaderDisconnected",e[e.CardInserted=3]="CardInserted",e[e.CardRemoved=4]="CardRemoved"})(R||(R={}));(function(e){w(r,e);function r(t){var o=e.call(this)||this;return o.channel=new j("smartcards",t),o.channel.onCommunicationError=o.onConnectionFailed.bind(o),o.channel.onNotification=o.processNotification.bind(o),o}return r.prototype.on=function(t,o){return this._on(t,o)},r.prototype.off=function(t,o){return this._off(t,o)},r.prototype.enumerateReaders=function(){return this.channel.send(new v(new m(D.EnumerateReaders))).then(function(t){var o=JSON.parse(f.Utf8.fromBase64Url(t.Data||"{}"));return JSON.parse(o.Readers||"[]")})},r.prototype.enumerateCards=function(){return this.channel.send(new v(new m(D.EnumerateCards))).then(function(t){var o=JSON.parse(f.Utf8.fromBase64Url(t.Data||"{}")),u=JSON.parse(o.Cards||"[]");return u.map(function(h){return JSON.parse(f.Utf16.fromBase64Url(h))})})},r.prototype.getCardInfo=function(t){return this.channel.send(new v(new m(D.GetCardInfo,f.Base64Url.fromJSON({Reader:t})))).then(function(o){var u=JSON.parse(f.Utf8.fromBase64Url(o.Data||"null"));return u})},r.prototype.getCardUid=function(t){return this.channel.send(new v(new m(D.GetCardUID,f.Base64Url.fromJSON({Reader:t})))).then(function(o){var u=f.Base64.fromBase64Url(o.Data||"");return u})},r.prototype.getCardAuthData=function(t,o){return this.channel.send(new v(new m(D.GetDPCardAuthData,f.Base64Url.fromJSON({Reader:t,PIN:o||""})))).then(function(u){var h=JSON.parse(f.Utf8.fromBase64Url(u.Data||""));return h})},r.prototype.getCardEnrollData=function(t,o){return this.channel.send(new v(new m(D.GetDPCardEnrollData,f.Base64Url.fromJSON({Reader:t,PIN:o||""})))).then(function(u){var h=JSON.parse(f.Utf8.fromBase64Url(u.Data||""));return h})},r.prototype.subscribe=function(t){return this.channel.send(new v(new m(D.Subscribe,t?f.Base64Url.fromJSON({Reader:t}):""))).then()},r.prototype.unsubscribe=function(t){return this.channel.send(new v(new m(D.Unsubscribe,t?f.Base64Url.fromJSON({Reader:t}):""))).then()},r.prototype.onConnectionFailed=function(){this.emit(new y)},r.prototype.processNotification=function(t){switch(t.Event){case R.ReaderConnected:return this.emit(new Q(t.Reader));case R.ReaderDisconnected:return this.emit(new nn(t.Reader));case R.CardInserted:return this.emit(new hn(t.Reader,t.Card));case R.CardRemoved:return this.emit(new ln(t.Reader,t.Card));default:console.log("Unknown notification: "+t.Event)}},r})(G);var $;(function(e){e[e.Persistent=0]="Persistent",e[e.Volatile=1]="Volatile"})($||($={}));var X;(function(e){e[e.Unknown=0]="Unknown",e[e.Swipe=1]="Swipe",e[e.Area=2]="Area",e[e.AreaMultifinger=3]="AreaMultifinger"})(X||(X={}));var z;(function(e){e[e.Unknown=0]="Unknown",e[e.Optical=1]="Optical",e[e.Capacitive=2]="Capacitive",e[e.Thermal=3]="Thermal",e[e.Pressure=4]="Pressure"})(z||(z={}));var Y;(function(e){e[e.Raw=1]="Raw",e[e.Intermediate=2]="Intermediate",e[e.Compressed=3]="Compressed",e[e.PngImage=5]="PngImage"})(Y||(Y={}));var Z;(function(e){e[e.Good=0]="Good",e[e.NoImage=1]="NoImage",e[e.TooLight=2]="TooLight",e[e.TooDark=3]="TooDark",e[e.TooNoisy=4]="TooNoisy",e[e.LowContrast=5]="LowContrast",e[e.NotEnoughFeatures=6]="NotEnoughFeatures",e[e.NotCentered=7]="NotCentered",e[e.NotAFinger=8]="NotAFinger",e[e.TooHigh=9]="TooHigh",e[e.TooLow=10]="TooLow",e[e.TooLeft=11]="TooLeft",e[e.TooRight=12]="TooRight",e[e.TooStrange=13]="TooStrange",e[e.TooFast=14]="TooFast",e[e.TooSkewed=15]="TooSkewed",e[e.TooShort=16]="TooShort",e[e.TooSlow=17]="TooSlow",e[e.ReverseMotion=18]="ReverseMotion",e[e.PressureTooHard=19]="PressureTooHard",e[e.PressureTooLight=20]="PressureTooLight",e[e.WetFinger=21]="WetFinger",e[e.FakeFinger=22]="FakeFinger",e[e.TooSmall=23]="TooSmall",e[e.RotatedTooMuch=24]="RotatedTooMuch"})(Z||(Z={}));var mn=function(e){w(r,e);function r(t,o,u){var h=e.call(this,"SamplesAcquired",t)||this;return h.sampleFormat=o,h.samples=JSON.parse(u),h}return r}(g),vn=function(e){w(r,e);function r(t,o){var u=e.call(this,"QualityReported",t)||this;return u.quality=o,u}return r}(g),wn=function(e){w(r,e);function r(t,o){var u=e.call(this,"ErrorOccurred",t)||this;return u.error=o,u}return r}(g),Dn=function(e){w(r,e);function r(t){return e.call(this,"AcquisitionStarted",t)||this}return r}(g),pn=function(e){w(r,e);function r(t){return e.call(this,"AcquisitionStopped",t)||this}return r}(g),O;(function(e){e[e.EnumerateDevices=1]="EnumerateDevices",e[e.GetDeviceInfo=2]="GetDeviceInfo",e[e.StartAcquisition=3]="StartAcquisition",e[e.StopAcquisition=4]="StopAcquisition"})(O||(O={}));var p;(function(e){e[e.Completed=0]="Completed",e[e.Error=1]="Error",e[e.Disconnected=2]="Disconnected",e[e.Connected=3]="Connected",e[e.Quality=4]="Quality",e[e.Stopped=10]="Stopped",e[e.Started=11]="Started"})(p||(p={}));(function(e){w(r,e);function r(t){var o=e.call(this)||this;return o.options=t,o.channel=new j("fingerprints",o.options),o.channel.onCommunicationError=o.onConnectionFailed.bind(o),o.channel.onNotification=o.processNotification.bind(o),o}return r.prototype.on=function(t,o){return this._on(t,o)},r.prototype.off=function(t,o){return this._off(t,o)},r.prototype.enumerateDevices=function(){return this.channel.send(new v(new m(O.EnumerateDevices))).then(function(t){if(!t)return[];var o=JSON.parse(f.Utf8.fromBase64Url(t.Data||"{}"));return JSON.parse(o.DeviceIDs||"[]")})},r.prototype.getDeviceInfo=function(t){return this.channel.send(new v(new m(O.GetDeviceInfo,f.Base64Url.fromJSON({DeviceID:t})))).then(function(o){var u=JSON.parse(f.Utf8.fromBase64Url(o.Data||"null"));return u})},r.prototype.startAcquisition=function(t,o){return this.channel.send(new v(new m(O.StartAcquisition,f.Base64Url.fromJSON({DeviceID:o||"00000000-0000-0000-0000-000000000000",SampleType:t})))).then()},r.prototype.stopAcquisition=function(t){return this.channel.send(new v(new m(O.StopAcquisition,f.Base64Url.fromJSON({DeviceID:t||"00000000-0000-0000-0000-000000000000"})))).then()},r.prototype.onConnectionFailed=function(){this.emit(new y)},r.prototype.processNotification=function(t){switch(t.Event){case p.Completed:var o=JSON.parse(f.Utf8.fromBase64Url(t.Data||""));return this.emit(new mn(t.Device,o.SampleFormat,o.Samples));case p.Error:var u=JSON.parse(f.Utf8.fromBase64Url(t.Data||""));return this.emit(new wn(t.Device,u.uError));case p.Disconnected:return this.emit(new nn(t.Device));case p.Connected:return this.emit(new Q(t.Device));case p.Quality:var h=JSON.parse(f.Utf8.fromBase64Url(t.Data||""));return this.emit(new vn(t.Device,h.Quality));case p.Stopped:return this.emit(new pn(t.Device));case p.Started:return this.emit(new Dn(t.Device));default:console.log("Unknown notification: "+t.Event)}},r})(G);var b;(function(e){e[e.Init=1]="Init",e[e.Continue=2]="Continue",e[e.Term=3]="Term",e[e.Authenticate=4]="Authenticate"})(b||(b={}));var M;(function(e){e[e.Response=0]="Response",e[e.Notification=1]="Notification"})(M||(M={}));(function(e){w(r,e);function r(t){var o=e.call(this)||this;return o.channel=new j("wia",t),o.channel.onCommunicationError=o.onConnectionFailed.bind(o),o}return r.prototype.on=function(t,o){return this._on(t,o)},r.prototype.off=function(t,o){return this._off(t,o)},r.prototype.init=function(){return this.channel.send(new v(new m(b.Init)),3e3).then(function(t){var o=JSON.parse(t.Data||"{}");return{handle:o.Handle,data:o.Data}})},r.prototype.continue=function(t,o){return this.channel.send(new v(new m(b.Continue,JSON.stringify({Handle:t,Data:o})))).then(function(u){var h=JSON.parse(u.Data||"{}");return h.Data})},r.prototype.term=function(t){return this.channel.send(new v(new m(b.Term,JSON.stringify({Handle:t})))).then()},r.prototype.onConnectionFailed=function(){this.emit(new y)},r})(G);
